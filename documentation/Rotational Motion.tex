\documentclass[10pt, a4paper, twoside]{basestyle}

\usepackage{tikz}
\usetikzlibrary{cd}

\usepackage[Mathematics]{semtex}
\usepackage{chngcntr}
\counterwithout{equation}{section}

%%%% Shorthands.

\newcommand{\squarenorm}[1]{\scal{#1}{#1}}

%%%% Title and authors.

\title{Rotational Motion of a Rigid Reference Frame}
\date{\printdate{2020-06-03}}
\author{Pascal~Leroy (phl)}
\begin{document}
\maketitle
\begin{sloppypar}
\noindent
This document describes the computations that are performed by the class \texttt{RigidReferenceFrame} and its subclasses to determine the rotational motion (rotation,
angular velocity, and angular accelation) of a rigid frame.
\end{sloppypar}

\section*{Definitions}
We consider in this document a rigid reference frame that is defined by two bodies $B_1$ and $B_2$ at positions $\vq_1$ and $\vq_2$, respectively.  A basis of the reference frame is defined by three vectors:
\begin{itemize}
\item{the \emph{fore} vector $\vF$ which is along the axis $\vq_2 - \vq_1$;}
\item{the \emph{normal} vector $\vN$ which is orthogonal to $\vF$ and is such that the velocity of the frame, $\dot{\vq_2} - \dot{\vq_1}$, is in the plane $\pa{\vF, \vN}$;}
\item{the \emph{binormal} vector $\vB$ which is orthogonal to $\vF$ and $\vN$ such that $\pa{\vF, \vN, \vB}$ forms a direct trihedron.}
\end{itemize}
There are obviously many possible choices for $\pa{\vF, \vN, \vB}$.  In practice, it is convenient to choose $\vB$ before $\vN$ so that the basis is defined exclusively using vector products:
\begin{equation}
\begin{dcases}
\vF &= \vr \\
\vB &= \vr \wedge \dot{\vr} \\
\vN &= \vB \wedge \vF
\end{dcases}
\label{eqnFBN}
\end{equation}
where we have defined $\vr \DefineAs \vq_2 - \vq_1$.  Is trivial to check that these definitions satisfy the properties above, and in particular that they determine a direct orthogonal basis.  The corresponding orthonormal basis is:
\begin{equation}
\begin{dcases}
\vf &= \frac{\vF}{\norm\vF} \\
\vb &= \frac{\vB}{\norm\vB} \\
\vn &= \frac{\vN}{\norm\vN}
\end{dcases}
\label{eqnfbn}
\end{equation}
These vectors are sufficient to define the rotation of the reference frame at any point in time.
\section*{Derivatives of normalized vectors}
In what follows, we will need to compute the time derivatives of the elements of the trihedron $\pa{\vf, \vn, \vb}$.  To help with this we prove two formulæ that define the first and second derivatives of $\vV/{\norm\vV}$ based on that of $\vV$.

The first derivative is:
\begin{align}
\deriv{t}{}\frac{\vV}{\norm\vV} &= \frac{\norm\vV \dot{\vV} - \deriv{t}{\norm\vV} \vV}{\norm\vV^2} \nonumber \\
&=\frac{\norm\vV \dot{\vV} - \frac{\pascal{\scal{\vV}{\dot{\vV}}}}{\norm\vV} \vV}{\norm\vV^2} \nonumber \\
&=\frac{\dot{\vV}}{\norm\vV} - \vV \frac{\pascal{\scal{\vV}{\dot{\vV}}}}{\norm\vV^3}
\label{eqndv}
\end{align}

The second derivative is somewhat more complicated:
\begin{align}
\deriv[2]{t}{}\frac{\vV}{\norm\vV} &=\deriv{t}{}\pa{\frac{\norm\vV^2 \dot{\vV} - \pascal{\scal{\vV}{\dot{\vV}}} \vV}{\norm\vV^3}} \nonumber \\
&=\frac{\norm\vV^3 \deriv{t}{}\pa{\norm\vV^2 \dot{\vV} - \pascal{\scal{\vV}{\dot{\vV}}} \vV} - 
  3 \norm\vV \pascal{\scal{\vV}{\dot{\vV}}}\pa{\norm\vV^2 \dot{\vV} - \pascal{\scal{\vV}{\dot{\vV}}} \vV}}{\norm\vV^6} \nonumber \\
&=\frac{2 \pascal{\scal{\vV}{\dot{\vV}}} \dot{\vV} +
    \norm\vV^2 \ddot{\vV} -
    \pa{\norm{\dot{\vV}}^2 + \pascal{\scal{\vV}{\ddot{\vV}}}} \vV -
    \pascal{\scal{\vV}{\dot{\vV}}} \dot{\vV}}
    {\norm\vV^3} -
  3\frac{\norm\vV^3 \pascal{\scal{\vV}{\dot{\vV}}} \dot{\vV} - \norm\vV \pascal{\scal{\vV}{\dot{\vV}}}^2 \vV}
    {\norm\vV^6} \nonumber \\
&=\frac{\ddot{\vV}}{\norm\vV} - 2 \dot{\vV} \frac{\pascal{\scal{\vV}{\dot{\vV}}}}{\norm\vV^3} 
  - \vV \frac{\norm{\dot{\vV}}^2 + \pascal{\scal{\vV}{\ddot{\vV}}}}{\norm\vV^3} + 3 \vV \frac{\pascal{\scal{\vV}{\dot{\vV}}}^2}{\norm\vV^5}
\label{eqnddv}
\end{align}

\section*{Angular velocity}
To compute the angular velocity, we derive the vectors (\ref{eqnFBN}) and obtain:
\begin{equation}
\begin{dcases}
\dot{\vF} &= \dot{\vr} \\
\dot{\vB} &= \vr \wedge \ddot{\vr} \\
\dot{\vN} &= \dot{\vB} \wedge \vF + \vB \wedge \dot{\vF}
\end{dcases}
\label{eqndFBN}
\end{equation}
Injecting these expressions in the derivative formula (\ref{eqndv}) makes it possible to compute the trihedron of the derivatives $\pa{\dot{\vf}, \dot{\vn}, \dot{\vb}}$ of (\ref{eqnfbn}).  The angular velocity is then written:
\[
\VectorSymbol{\gw} = \pascal{\scal{\dot{\vn}}{\vb}} \vf + \pascal{\scal{\dot{\vb}}{\vf}} \vn + \pascal{\scal{\dot{\vf}}{\vn}} \vb
\]

\section*{Angular acceleration}
To compute the angular acceleration, we derive the vectors (\ref{eqndFBN}) and obtain:
\begin{equation}
\begin{dcases}
\ddot{\vF} &= \ddot{\vr} \\
\ddot{\vB} &= \dot{\vr} \wedge \ddot{\vr} + \vr \wedge \vr^{(3)} \\
\ddot{\vN} &= \ddot{\vB} \wedge \vF + 2 \dot{\vB} \wedge \dot{\vF} + \vB \wedge \ddot{\vF} \\
\end{dcases}
\end{equation}
Injecting these expressions in the second derivative formula (\ref{eqnddv}) makes it possible to compute the trihedron of the second derivatives $\pa{\ddot{\vf}, \ddot{\vn}, \ddot{\vb}}$ of (\ref{eqnfbn}).  The angular acceleration is then written:
\begin{align*}
\dot{\VectorSymbol{\gw}} &= \pascal{\scal{\ddot{\vn}}{\vb}} \vf + \pascal{\scal{\dot{\vn}}{\dot{\vb}}} \vf + \pascal{\scal{\dot{\vn}}{\vb}} \dot{\vf} \\
&+ \pascal{\scal{\ddot{\vb}}{\vf}} \vn + \pascal{\scal{\dot{\vb}}{\dot{\vf}}} \vn + \pascal{\scal{\dot{\vb}}{\vf}} \dot{\vn} \\
&+ \pascal{\scal{\ddot{\vf}}{\vn}} \vb + \pascal{\scal{\dot{\vf}}{\dot{\vn}}} \vb + \pascal{\scal{\dot{\vf}}{\vn}} \dot{\vb}
\end{align*}

\section*{Application to the body surface reference frame}
While the formulæ above were derived assuming a rigid reference frame defined by two bodies $B_1$ and $B_2$, they remain valid for a reference frame defined by a single body $B_1$ provided that we give a proper definition of the vector $\vr$.  We now consider how they apply to the \textit{body surface} reference frame.

It is convenient to choose $\vr$ to be a unit vector rotating with the surface of the body; without loss of generality, $\vr$ may be written:
\[
\vr = \vx \cos \pa{\gw t + \gj} + \vy \sin \pa{\gw t + \gj}
\]
where $\vx$ and $\vy$ form a direct orthonormal basis of the equatorial plane of the body.  The time derivatives of $\vr$ are:
\[
\begin{dcases}
\dot{\vr} &= -\vx \gw \sin \pa{\gw t + \gj} + \vy \gw \cos \pa{\gw t + \gj} \\
\ddot{\vr} &= -\vx \gw^2 \cos \pa{\gw t + \gj} - \vy \gw^2 \sin \pa{\gw t + \gj} = -\gw^2 \vr \\
\vr^{(3)} &= \vx \gw^3 \sin \pa{\gw t + \gj} - \vy \gw^3 \cos \pa{\gw t + \gj} = -\gw^2 \dot{\vr}
\end{dcases}
\]
Using (\ref{eqnFBN}) it's easy to see that:
\[
\begin{dcases}
\vF &= \vr \\
\vB &= \gw \vz \\
\vN &= \dot{\vr}
\end{dcases}
\]
where $\vz$ is along the rotation axis such that $\pa{\vx, \vy, \vz}$ form a direct trihedron.  The orthonormal vectors follow immediately, noting that $\norm\vr = 1$:
\[
\begin{dcases}
\vf &= \vr \\
\vb &= \vz \\
\vn &= \frac{\dot{\vr}}{\gw}
\end{dcases}
\]
The first derivatives of the orthonormal trihedron can be computed directly:
\[
\begin{dcases}
\dot{\vf} &= \dot{\vr} \\
\dot{\vb} &= 0 \\
\dot{\vn} &= \frac{\ddot{\vr}}{\gw} = -\gw \vr
\end{dcases}
\]
which yields, not surprisingly, $\VectorSymbol{\gw} = \gw \vz$.  The second derivatives are equally straightforward:
\[
\begin{dcases}
\ddot{\vf} &= \ddot{\vr} = -\vr \\
\dot{\vb} &= 0 \\
\dot{\vn} &= -\gw \dot{\vr}
\end{dcases}
\]
and yield, as expected, $\dot{\VectorSymbol{\gw}} = 0$.

\end{document}