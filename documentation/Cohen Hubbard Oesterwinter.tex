\documentclass[10pt, a4paper, twoside]{basestyle}

\usepackage[backend=biber,firstinits=true,maxnames=100,style=alphabetic,maxalphanames=4,doi=true,isbn=false,url=false,eprint=true]{biblatex}
\bibliography{bibliography}

\usepackage[Mathematics]{semtex}
\usepackage{chngcntr}
\counterwithout{equation}{section}

%%%% Shorthands.

%%%% Title and authors.

\title{%
\textdisplay{%
On a Formula by Cohen, Hubbard and Oesterwinter%
}%
}
\date{\printdate{2021-03-13}}
\author{Robin~Leroy (eggrobin) \& Pascal~Leroy (phl)}
\begin{document}
\maketitle
\begin{sloppypar}
\noindent
This document proves and generalizes a formula given in \cite{CohenHubbardOesterwinter1973} to compute the velocity of a body in the context of 12th-order numerical integration of $n$-body systems.
\end{sloppypar}

\subsection*{Statement}
\cite{CohenHubbardOesterwinter1973} states that
\begin{quotation}
the formula for a velocity component [is] of the form:
\begin{equation}
\TimeDerivative{x}_{n + 1} = \frac{x_n - x_{n - 1} + h^2 \sum{i = 0}[12] \gb_i \SecondTimeDerivative{x}_{n-i}}{h}
\label{eqncho}
\end{equation}
\end{quotation}
They then proceed to give explicit values for the (rational) coefficients $\gb_i$ without explaining how they are computed.  This makes it impossible to use this formula for integrators of a different order.

\subsection*{Lemma}
\cite{Fornberg1987} gives finite difference formulæ for any order and for kernels of arbitrary size.  Given a sufficient regular function $f\of{x}$ and a family $\VectorSymbol{\ga} = \pa{\ga_0, \ga_1, ..., \ga_N}$ of points (which may not be equidistant), the $m$-th derivative at any point $x_0$ may be approximated to order $n - m + 1$ as:
\[
f^{(m)}\of{x_0} ≅ \sum{\gn = 0}[n]{\gd^{m}_{n,\gn}\of{\VectorSymbol{\ga}} f\of{\ga_\gn}}
\]
where the coefficients $\gd^{m}_{n,\gn}$ are dependent on $\VectorSymbol{\ga}$ but independent of $f$.

If the $\VectorSymbol{\ga}$ are equally spaced with step $h$ (i.e., $\ga_\gn = x_0 + \gn h$) then we can write a forward formula as follows:
\begin{equation}
f^{(m)}\of{x_0} = \sum{\gn = 0}[n]{\gd^{m}_{n,\gn}\of{x_0, h} f\of{x_0 + \gn h}} + \BigO\of{h^{n - m + 1}}
\label{fornbergforwardpreliminary}
\end{equation}

In this case equation (3.8) from \cite{Fornberg1987} may be rewritten as follows, restoring $x_0$:
\begin{align*}
\gd^{m}_{n,\gn} &= \frac{1}{\ga_n - \ga_\gn}\pa{\pa{\ga_n - x_0} \gd^{m}_{n - 1,\gn} - m \gd^{m - 1}_{n - 1,\gn}}\\
&= \frac{1}{\pa{n - \gn} h} \pa{n h \gd^{m}_{n - 1,\gn} - m \gd^{m - 1}_{n - 1,\gn}}
\end{align*}

It is convenient to extract the powers of $h$ from the coefficients:
\[
\gd^{m}_{n,\gn}\of{x_0, h} = \frac{\gl^{m}_{n,\gn}}{h^m}
\]
where $\gl^{m}_{n,\gn}$ is independent from $x_0$ and $h$.  We can check that equation (3.8) is still verified by multiplying both sides by $h^m$:
\[
\gl^{m}_{n,\gn} = \frac{1}{n - \gn} \pa{n \gl^{m}_{n - 1,\gn} - m \gl^{m - 1}_{n - 1,\gn}}
\]

and rewrite equation (\ref{fornbergforwardpreliminary}) as:
\begin{equation}
f^{(m)}\of{x_0} = \frac{1}{h^m} \sum{\gn = 0}[n]{\gl^{m}_{n,\gn} f\of{x_0 + \gn h}} + \BigO\of{h^{n - m + 1}}
\label{fornbergforward}
\end{equation}


\subsection*{Derivation}
In this section we derive equation (\ref{eqncho}) and obtain an explicit expression for the coefficients appearing in the sum, using equation (\ref{fornbergforward}) from the preceding lemma.

We start by writing the Taylor series of $f\of{x_0 + h}$ for $h$ close to $0$, extracting the leading terms:
\begin{align}
f\of{x_0 + h} &= \sum{m = 0}[\infty]{\frac{f^{(m)}\of{x_0}}{\Factorial{m}} h^m} \nonumber \\
&=f\of{x_0} + h f\der\of{x_0} + \sum{m = 2}[\infty]{\frac{f^{(m)}\of{x_0}}{\Factorial{m}} h^m} \nonumber \\
&=f\of{x_0} + h f\der\of{x_0} + \sum{m = 2}[n]{\frac{f^{(m)}\of{x_0}}{\Factorial{m}} h^m} + \BigO\of{h^{n+1}} \label{eqntaylor}
\end{align}

Equation (\ref{fornbergforward}) can be applied to the second derivative $f\dersecond\of{x_0}$ to yield an approximation which is still of order $n - m + 1$:
\[
f^{(m)}\of{x_0} = \frac{1}{h^m} \sum{\gn = 0}[n - 2]{\gl^{m - 2}_{n - 2,\gn} f\dersecond\of{x_0 + \gn h}} + \BigO\of{h^{n - m + 1}}
\]

Injecting this expression into equation (\ref{eqntaylor}) we find:
\[
f\of{x_0 + h} = f\of{x_0} + h f\der\of{x_0} + \sum{m = 2}[n]{\sum{\gn = 0}[n - 2]{\gl^{m - 2}_{n - 2,\gn} f\dersecond\of{x_0 + \gn h}}} + \BigO\of{h^{n + 1}}
\]

The summations are independent and can be exchanged:
\[
f\of{x_0 + h} = f\of{x_0} + h f\der\of{x_0} + \sum{\gn = 0}[n - 2]{\pa{\sum{m = 2}[n]{\gl^{m - 2}_{n - 2,\gn}}} f\dersecond\of{x_0 + \gn h}} + \BigO\of{h^{n + 1}}
\]

We can then define:
\[
\gh_{n, \gn} \DefineAs \sum{m = 2}[n]{\gl^{m - 2}_{n,\gn}}
\]



\subsection*{Conclusion}
We have demonstrated how \cite{Fukushima2018} uses different techniques from the ones detailed in \cite{Fukushima2011a} in order to handle the 
logarithmic singularities of the $B$ and $D$ complete integrals of the second kind: while \cite{Fukushima2011a} divides the leading logarithmic term $\log \frac{m_c}{16}$, \cite{Fukushima2018} divides the complete logarithmic term $\log q\of{m_c}$.
\printbibliography
\end{document}